# Phala Cloud TEE Deployment Configuration
# Sofia-Mastra + Intuition MCP Server

name: sofia-mastra
image: maximesaintjoannis/sofia-mastra:latest

# Resources
resources:
  cpu: 2
  memory: 4096  # 4GB RAM

# Exposed ports
ports:
  - port: 4111
    protocol: tcp
    public: true   # Mastra API - accessible from outside

# Persistent storage
volumes:
  - name: mastra-data
    mount_path: /app/data
    size: 10  # 10GB

# Environment variables
env:
  - name: NODE_ENV
    value: "production"
  - name: DATABASE_URL
    value: "file:/app/data/mastra.db"
  - name: MCP_SERVER_URL
    value: "http://127.0.0.1:3001/sse"
  # GaiaNet configuration - set your values
  - name: GAIANET_BASE_URL
    value: "https://YOUR_GAIANET_NODE.gaianet.ai/v1"
  - name: GAIANET_API_KEY
    value: ""  # Optional, set if needed

# Health check
health_check:
  path: /api/health
  port: 4111
  interval: 30
  timeout: 10
  retries: 3

# TEE Configuration
tee:
  enabled: true
  attestation: true
